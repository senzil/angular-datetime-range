!function(e,t){if("object"==typeof exports&&"object"==typeof module)module.exports=t(require("angular"),require("moment"),require("moment-range"),require("moment-timezone"));else if("function"==typeof define&&define.amd)define(["angular","moment","moment-range","moment-timezone"],t);else{var n="object"==typeof exports?t(require("angular"),require("moment"),require("moment-range"),require("moment-timezone")):t(e.angular,e.moment,e["moment-range"],e["moment-timezone"]);for(var s in n)("object"==typeof exports?exports:e)[s]=n[s]}}(this,function(e,t,n,s){return function(e){function t(s){if(n[s])return n[s].exports;var a=n[s]={exports:{},id:s,loaded:!1};return e[s].call(a.exports,a,a.exports,t),a.loaded=!0,a.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){"use strict";function s(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var a=s(n(1)),d=s(n(2)),r=n(3);s(n(4));a.default.module("senzil.datetime-range",[]).constant("moment",(0,r.extendMoment)(d.default)),a.default.module("senzil.datetime-range").directive("timeRange",["$document","$timeout","moment",function(e,t,n){return{restrict:"E",scope:{ngModel:"=",includeSeconds:"<?",limitsRange:"<?",showClose:"<?",onChange:"&?",onChangeStart:"&?",onChangeEnd:"&?",onClose:"&?"},replace:!0,template:'<div class="datetime-range time-range"><div class="start-datetime" ng-click="selectStart(ngModel.start)" ng-class="{\'active\': selected === ngModel.start, \'warning\': warning === \'start\' }"><div class="time">{{ ngModel.start.format(includeSeconds ? \'HH : mm : ss\' : \'HH : mm\') }}</div></div><div class="end-datetime" ng-click="selectEnd(ngModel.end)" ng-class="{\'active\': selected === ngModel.end, \'warning\': warning === \'end\'}"><div class="time">{{ ngModel.end.format(includeSeconds ? \'HH : mm : ss\' : \'HH : mm\') }}</div></div><div class="edit-popover" ng-show="!!selected"><div class="timer"><div class="timer-hours" scroll-up="setDate(selected.clone().add(1, \'hours\'))" scroll-down="setDate(selected.clone().subtract(1, \'hours\'))"><div class="arrow arrow-up" ng-click="setDate(selected.clone().add(1, \'hours\'))"></div>{{ selected.format(\'HH\') }}<div class="arrow arrow-down" ng-click="setDate(selected.clone().subtract(1, \'hours\'))"></div></div><div class="timer-divider">:</div><div class="timer-minutes" scroll-up="setDate(selected.clone().add(1, \'minutes\'))" scroll-down="setDate(selected.clone().subtract(1, \'minutes\'))"><div class="arrow arrow-up" ng-click="setDate(selected.clone().add(1, \'minutes\'))"></div>{{ selected.format(\'mm\') }}<div class="arrow arrow-down" ng-click="setDate(selected.clone().subtract(1, \'minutes\'))"></div></div><div class="timer-divider" ng-show="!!includeSeconds">:</div><div class="timer-seconds" ng-show="!!includeSeconds" scroll-up="setDate(selected.clone().add(1, \'seconds\'))" scroll-down="setDate(selected.clone().subtract(1, \'seconds\'))"><div class="arrow arrow-up" ng-click="setDate(selected.clone().add(1, \'seconds\'))"></div>{{ selected.format(\'ss\') }}<div class="arrow arrow-down" ng-click="setDate(selected.clone().subtract(1, \'seconds\'))"></div></div></div><div class="close-button" ng-show="showClose"><div ng-click="close()">Close</div></div></div></div>',require:"ngModel",compile:function(){return{pre:function(){},post:function(s,a,d,r){function i(e){return n.tz({years:0,months:0,days:0,hours:e.hours(),minutes:e.minutes(),seconds:s.includeSeconds?e.seconds():0},"UTC")}function o(e,t){e!==t&&(s.limitsRange instanceof n.range.constructor||(s.limitsRange=i(n().startOf("day")).range("day")),n.isMoment(s.limitsRange.start)&&(s.limitsRange.start=i(s.limitsRange.start)),n.isMoment(s.limitsRange.end)&&(s.limitsRange.end=i(s.limitsRange.end)),s.limitsRange.valueOf()<0&&(console.warn("this directive doesn't support a range with negative value. Fallback to (null, null) all time constructor"),s.limitsRange=i(n().startOf("day")).range("day")))}r&&(s.includeSeconds=!!s.includeSeconds,s.showClose=!!s.showClose,s.current=i(n.tz()),o(s.limitsRange),s.ngModel instanceof n.range.constructor||(s.ngModel=n.range(i(s.current),i(s.current))),n.isMoment(s.ngModel.start)&&(s.ngModel.start=i(s.ngModel.start)),n.isMoment(s.ngModel.end)&&(s.ngModel.end=i(s.ngModel.end)),r.$render=function(){var e=r.$modelValue||r.$viewValue;e instanceof n.range.constructor&&(e.start=i(e.start),e.end=i(e.end))},r.$validators.timerange=function(e,t){var n=e||t;if(n){if(!d.required&&!n)return!0;if(!s.limitsRange)return!0;var a=s.limitsRange.intersect(n);return a&&a.isSame(n)}return!d.required},r.$formatters.push(function(e){return e instanceof n.range.constructor||(e=i(s.current)),n.isMoment(e.start)&&(e.start=i(e.start)),n.isMoment(e.end)&&(e.end=i(e.end)),e}),r.$parsers.push(function(e){return e||null}),s.selectStart=function(e){return e||(s.ngModel.start=s.current.within(s.limitsRange)?s.current:s.current<s.limitsRange.start?s.limitsRange.start:s.limitsRange.end,e=s.ngModel.start),s.selectDate(e)},s.selectEnd=function(e){return e||(s.ngModel.end=s.current.within(s.limitsRange)?s.current:s.current<s.limitsRange.start?s.limitsRange.start:s.limitsRange.end,e=s.ngModel.end),s.selectDate(e)},s.selectDate=function(e){n.isMoment(s.selected)&&s.selected.isSame(e)?s.selected=void 0:s.selected=e},s.setDate=function(e){if(!s.selected.isSame(e)){var a=s.selected===s.ngModel.start?n.range(i(n().startOf("day")),s.ngModel.end):n.range(s.ngModel.start,i(n().endOf("day")));(s.limitsRange?s.limitsRange:i(n().startOf("day")).range("day")).intersect(a).contains(e)?(s.selected.hours(e.hours()).minutes(e.minutes()).seconds(s.includeSeconds?e.seconds():0),r.$validate(),r.$setDirty(),s.callback()):(s.warning=s.selected===s.ngModel.start?"start":"end",t(function(){s.warning=void 0},250))}},s.callback=function(){s.onChangeStart&&s.selected===s.ngModel.start&&s.onChangeStart(),s.onChangeEnd&&s.selected===s.ngModel.end&&s.onChangeEnd(),s.onChange&&s.onChange()},s.close=function(){s.selected=null,s.onClose&&s.onClose()},e.on("mousedown",function(e){s.selected&&!a[0].contains(e.target)&&s.$apply(s.close)}),e.on("keyup",function(e){27===e.keyCode&&s.selected&&s.$apply(s.close)}),s.$watch("limitsRange",o))}}}}}]),a.default.module("senzil.datetime-range").directive("datetimeRange",["$document","$timeout","moment",function(e,t,n){return{restrict:"E",scope:{ngModel:"=",timezone:"<?",includeSeconds:"<?",showClose:"<?",limitsRange:"<?",onChange:"&?",onChangeStart:"&?",onChangeEnd:"&?",onClose:"&?"},replace:!0,template:"<div class=\"datetime-range\"><div class=\"start-datetime\" ng-click=\"selectStart(ngModel.start)\" ng-class=\"{'active': selected === ngModel.start, 'warning': warning === 'start' }\"><div class=\"date\">{{ ngModel.start.format('DD MMMM YYYY') }}</div><div class=\"time\">{{ ngModel.start.format(includeSeconds ? 'HH : mm : ss' : 'HH : mm') }}</div></div><div class=\"end-datetime\" ng-click=\"selectEnd(ngModel.end)\" ng-class=\"{'active': selected === ngModel.end, 'warning': warning === 'end'}\"><div class=\"date\">{{ ngModel.end.format('DD MMMM YYYY') }}</div><div class=\"time\">{{ ngModel.end.format(includeSeconds ? 'HH : mm : ss' : 'HH : mm') }}</div></div><div class=\"edit-popover\" ng-show=\"!!selected\"><div class=\"calendar-toggle\" ng-class=\"{'start': selected === ngModel.start, 'end': selected === end}\" ng-click=\"calendar_active = !calendar_active\">{{ selected.format('DD MMMM YYYY') }}</div><div class=\"calendar\" ng-show=\"!!calendar_active\"><div class=\"calendar-header\"><div class=\"arrow arrow-left\" ng-click=\"calendar.subtract(1, 'months')\"></div>{{ calendar.format('MMMM') }}<div class=\"arrow arrow-right\" ng-click=\"calendar.add(1, 'months')\"></div></div><div class=\"calendar-body\"><div class=\"weekdays\"><span class=\"weekday\" ng-repeat=\"weekday in 'weeeeek' track by $index\">{{ calendar.clone().startOf('week').add($index, 'days').format('ddd') }}</span></div><div class=\"week\" ng-repeat=\"week in 'months' | limitTo: ((calendar.clone().endOf('month').week() - calendar.clone().startOf('month').week()) + 1) track by $index\"><span class=\"date\" ng-repeat=\"date in 'weeeeek' track by $index\" ng-class=\"{ 'current': calendar.clone().startOf('month').add($parent.$index, 'weeks').weekday($index).startOf('day').isSame(current.clone().startOf('day')), 'active': calendar.clone().startOf('month').add($parent.$index, 'weeks').weekday($index).startOf('day').isSame(selected.clone().startOf('day')), 'inactive': calendar.clone().startOf('month').add($parent.$index, 'weeks').weekday($index).month() !== calendar.month() }\" ng-click=\"setDate(selected.clone().year(calendar.clone().startOf('month').add($parent.$index, 'weeks').weekday($index).year()).month(calendar.clone().startOf('month').add($parent.$index, 'weeks').weekday($index).month()).date(calendar.clone().startOf('month').add($parent.$index, 'weeks').weekday($index).date()), true)\">{{ calendar.clone().startOf('month').add($parent.$index, 'weeks').weekday($index).date() }}</span></div></div></div><div class=\"timer\"><div class=\"timer-hours\" scroll-up=\"setDate(selected.clone().add(1, 'hours'))\" scroll-down=\"setDate(selected.clone().subtract(1, 'hours'))\"><div class=\"arrow arrow-up\" ng-click=\"setDate(selected.clone().add(1, 'hours'))\"></div>{{ selected.format('HH') }}<div class=\"arrow arrow-down\" ng-click=\"setDate(selected.clone().subtract(1, 'hours'))\"></div></div><div class=\"timer-divider\">:</div><div class=\"timer-minutes\" scroll-up=\"setDate(selected.clone().add(1, 'minutes'))\" scroll-down=\"setDate(selected.clone().subtract(1, 'minutes'))\"><div class=\"arrow arrow-up\" ng-click=\"setDate(selected.clone().add(1, 'minutes'))\"></div>{{ selected.format('mm') }}<div class=\"arrow arrow-down\" ng-click=\"setDate(selected.clone().subtract(1, 'minutes'))\"></div></div><div class=\"timer-divider\" ng-show=\"!!includeSeconds\">:</div><div class=\"timer-seconds\" ng-show=\"!!includeSeconds\" scroll-up=\"setDate(selected.clone().add(1, 'seconds'))\" scroll-down=\"setDate(selected.clone().subtract(1, 'seconds'))\"><div class=\"arrow arrow-up\" ng-click=\"setDate(selected.clone().add(1, 'seconds'))\"></div>{{ selected.format('ss') }}<div class=\"arrow arrow-down\" ng-click=\"setDate(selected.clone().subtract(1, 'seconds'))\"></div></div></div><div class=\"close-button\" ng-show=\"showClose\"><div ng-click=\"close()\">Close</div></div></div></div>",require:"ngModel",compile:function(){return{pre:function(){},post:function(s,a,d,r){function i(e,t){e!==t&&(s.timezone=s.timezone||n.tz.guess(),o(s.limitsRange),s.ngModel instanceof n.range.constructor||(s.ngModel=n.range(s.current,s.current)),n.isMoment(s.ngModel.start)&&(s.ngModel.start=n.tz(s.ngModel.start,s.timezone)),n.isMoment(s.ngModel.end)&&(s.ngModel.end=n.tz(s.ngModel.end,s.timezone)))}function o(e,t){e!==t&&(s.limitsRange instanceof n.range.constructor?s.limitsRange.valueOf()<0&&(console.warn("this directive doesn't support a range with negative value. Fallback to (null, null) all time constructor"),s.limitsRange=n.range(null,null)):s.limitsRange=n.range(null,null),n.isMoment(s.limitsRange.start)&&(s.limitsRange.start=n.tz(s.limitsRange.start,s.timezone)),n.isMoment(s.limitsRange.end)&&(s.limitsRange.end=n.tz(s.limitsRange.end,s.timezone)))}r&&(s.includeSeconds=!!s.includeSeconds,s.showClose=!!s.showClose,s.current=n.tz(s.timezone),i(s.timezone),r.$render=function(){var e=r.$modelValue||r.$viewValue;e instanceof n.range.constructor&&(e.start=n.tz(e.start,s.timezone),e.end=n.tz(e.end,s.timezone))},r.$validators.timerange=function(e,t){var n=e||t;if(n){if(!d.required&&!n)return!0;if(!s.limitsRange)return!0;var a=s.limitsRange.intersect(n);return a&&a.isSame(n)}return!d.required},r.$formatters.push(function(e){return e instanceof n.range.constructor||(e=n.range(s.current,s.current)),n.isMoment(e.start)&&(e.start=n.tz(e.start,s.timezone)),n.isMoment(e.end)&&(e.end=n.tz(e.end,s.timezone)),e}),r.$parsers.push(function(e){return e||null}),s.selectStart=function(e){return e||(s.ngModel.start=s.current.within(s.limitsRange)?s.current:s.current<s.limitsRange.start?s.limitsRange.start:s.limitsRange.end,e=s.ngModel.start),s.selectDate(e)},s.selectEnd=function(e){return e||(s.ngModel.end=s.current.within(s.limitsRange)?s.current:s.current<s.limitsRange.start?s.limitsRange.start:s.limitsRange.end,e=s.ngModel.end),s.selectDate(e)},s.selectDate=function(e){n.isMoment(s.selected)&&s.selected.isSame(e)?s.selected=void 0:(s.selected=e,s.calendar=s.selected.clone())},s.setDate=function(e,a){if(!s.selected.isSame(e)){var d=s.selected===s.ngModel.start?n.range(null,s.ngModel.end):n.range(s.ngModel.start,null);(s.limitsRange?s.limitsRange:n.range(null,null)).intersect(d).contains(e)?(s.selected.year(e.year()).month(e.month()).date(e.date()).hours(e.hours()).minutes(e.minutes()).seconds(s.includeSeconds?e.seconds():0),(s.selected.clone().startOf("week").month()!==s.calendar.month()&&s.selected.clone().endOf("week").month()!==s.calendar.month()||a)&&(s.calendar=s.selected.clone()),r.$validate(),r.$setDirty(),s.callback()):(s.warning=s.selected===s.ngModel.start?"start":"end",t(function(){s.warning=void 0},250))}},s.callback=function(){s.onChangeStart&&s.selected===s.ngModel.start&&s.onChangeStart(),s.onChangeEnd&&s.selected===s.ngModel.end&&s.onChangeEnd(),s.onChange&&s.onChange()},s.close=function(){s.selected="",s.calendar_active=!1,s.onClose&&s.onClose()},e.on("mousedown",function(e){s.selected&&!a[0].contains(e.target)&&s.$apply(s.close)}),e.on("keyup",function(e){27===e.keyCode&&s.selected&&s.$apply(s.close)}),s.$watch("timezone",i),s.$watch("limitsRange",o))}}}}}]),a.default.module("senzil.datetime-range").directive("scrollUp",function(){return{restrict:"A",compile:function(){return{pre:function(){},post:function(e,t,n){t.on("DOMMouseScroll mousewheel wheel touchmove",function(t){((t=t.originalEvent||t).wheelDelta||-1*t.deltaY||0)>0&&(e.$apply(function(){e.$eval(n.scrollUp)}),t.preventDefault())})}}}}}),a.default.module("senzil.datetime-range").directive("scrollDown",function(){return{restrict:"A",compile:function(){return{pre:function(){},post:function(e,t,n){t.on("DOMMouseScroll mousewheel wheel touchmove",function(t){((t=t.originalEvent||t).wheelDelta||-1*t.deltaY||0)<0&&(e.$apply(function(){e.$eval(n.scrollDown)}),t.preventDefault())})}}}}}),t.default=a.default.module("senzil.datetime-range").name},function(t,n){t.exports=e},function(e,n){e.exports=t},function(e,t){e.exports=n},function(e,t){e.exports=s}])});